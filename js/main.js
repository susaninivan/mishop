(()=>{"use strict";const t=function(t){const n=document.createElement("div");n.classList.add("modal-backdrop"),n.classList.add("fade"),document.body.append(n),t.classList.add("d-block"),setTimeout((function(){n.classList.add("show"),t.classList.add("show")}),100)},n=function(t){const n=document.querySelector(".modal-backdrop");n&&n.classList.remove("show"),t.classList.remove("show"),setTimeout((function(){t.classList.remove("d-block"),n&&n.remove()}),500),t.classList.remove("d-block")},e="http://localhost:3001",o=function(t){return fetch(e+t).then((function(t){if(!1===t.ok)throw new Error("Ошибка...");return t.json()}))},c=function(t,n){return fetch(e+t,{method:"PATCH",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(t){if(!1===t.ok)throw new Error("Ошибка...");return t.json()}))};!function(){const e=document.getElementById("open-auth-btn"),c=document.getElementById("auth-modal"),a=c.querySelectorAll(".close-btn"),i=document.querySelector(".login-btn"),s=document.getElementById("logout-btn"),d=document.getElementById("open-cart-btn"),r=(document.getElementById("cart-modal"),function(){e.classList.add("d-none"),s.classList.remove("d-none"),d.classList.remove("d-none"),n(c)});e.addEventListener("click",(function(){t(c)})),a.forEach((function(t){t.addEventListener("click",(function(){n(c)}))})),i.addEventListener("click",(function(){const t=c.querySelector("#login-control"),n=c.querySelector("#password-control"),e=t.value,a=n.value;o("/profile").then((function(t){t.login&&t.login===e&&t.password&&t.password===a?(localStorage.setItem("auth",JSON.stringify(t)),r()):alert("Ви ввели не верние данние")}))})),s.addEventListener("click",(function(){localStorage.removeItem("auth"),e.classList.remove("d-none"),s.classList.add("d-none"),d.classList.add("d-none")})),function(){const t=JSON.parse(localStorage.getItem("auth"));t&&o("/profile").then((function(n){n.login&&n.login===t.login&&n.password&&n.password===t.password?r():alert("Ви ввели не верние данние")}))}()}(),function(){const t=document.getElementById("categories-container"),n=document.querySelector(".catalog-search"),e=function(n){t.innerHTML="",n.forEach((function(n){t.insertAdjacentHTML("beforeend",`\n                        <div class="col col-12 col-md-6 col-lg-4 mb-3">\n                            <a href="/catalog.html?id=${n.id}" class="card-link">\n                                <div class="card">\n                                    <img src="${n.preview}" class="card-img-top" alt="phones">\n                                    <div class="card-body">\n                                        <h5 class="card-title">${n.name}</h5>\n                                    </div>\n                                </div>\n                            </a>\n                        </div>\n            \n            \n            `)}))};n.addEventListener("input",(function(t){console.log(t.target.value),o(`/categories?q=${t.target.value}`).then((function(t){e(t)})).catch((function(t){}))})),o("/categories").then((function(t){e(t)})).catch((function(t){}))}(),function(){const e=document.getElementById("cart-container"),a=document.getElementById("cart-modal"),i=document.getElementById("open-cart-btn"),s=a.querySelectorAll(".close-btn"),d=document.getElementById("cart-totlal-price"),r=function(){o("/cart").then((function(t){!function(t){e.innerHTML="",t.forEach((function(t){e.insertAdjacentHTML("beforeend",`\n                        <div class="row border-bottom pb-3 pt-3">\n                            <div class="col col-12 col-md-6 mb-3 mb-md-0 fs-4">\n                                ${t.name}\n                            </div>\n                            <div class="col col-12 col-md-6 fs-4 d-flex align-items-center justify-content-end flex-wrap">\n                                <h4 class="me-3 d-flex align-itemns-center">${t.price} ₽</h4>\n                                <button type="button" class="btn btn-outline-dark btn-sm cart-item-controls"\n                                    id="control-dec" data-id="${t.id}" data-count="${t.count}">\n                                    -\n                                </button>\n                                <h6 class="cart-item-count me-3 ms-3">${t.count}</h6>\n                                <button type="button" class="btn btn-outline-dark btn-sm cart-item-controls"\n                                    id="control-inc" data-id="${t.id}" data-count="${t.count}">\n                                    +\n                                </button>\n                            </div>\n                        </div>\n            \n            `)}))}(t),l(t)})).catch((function(t){}))},l=function(t){let n=0;t.forEach((function(t){n=(n+Number(t.price))*Number(t.count)})),d.textContent=n+" ₽"};i.addEventListener("click",(function(){r(),t(a)})),s.forEach((function(t){t.addEventListener("click",(function(){n(a)}))})),e.addEventListener("click",(function(t){if(t.target.closest("button"))if(t.target.id&&"control-inc"===t.target.id){const n=t.target.dataset.id,e=Number(t.target.dataset.count);c(`/cart/${n}`,{count:e+1}).then((function(){r()}))}else if(t.target.id&&"control-dec"===t.target.id){const n=t.target.dataset.id,e=Number(t.target.dataset.count);e>0&&c(`/cart/${n}`,{count:e-1}).then((function(){r()}))}}))}()})();