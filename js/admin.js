(()=>{"use strict";const t="http://localhost:3001",e=function(e){return fetch(t+e).then((function(t){if(!1===t.ok)throw new Error("Ошибка...");return t.json()}))},n=function(e,n){return fetch(t+e,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(t){if(!1===t.ok)throw new Error("Ошибка...");return t.json()}))},o=function(e){return fetch(t+e,{method:"DELETE"}).then((function(t){if(!1===t.ok)throw new Error("Ошибка...");return t.json()}))};!function(){const t=document.getElementById("category-name"),c=document.getElementById("category-image"),r=document.getElementById("category-add-btn"),a=document.getElementById("category-container"),u=document.getElementById("product-category"),i={name:"",preview:""},d=function(){""===t.value||""===c.value?r.disabled=!0:r.disabled=!1},l=function(){e("/categories").then((function(t){!function(t){a.innerHTML=" ",t.forEach((function(t,e){a.insertAdjacentHTML("beforeend",`\n            <tr>\n                <th scope="row">${e+1}</th>\n                <td>${t.name}</td>\n                <td class="text-end">\n                    <button type="button" class="btn btn-outline-danger btn-sm" data-category= "${t.id}">\n                        удалить\n                    </button>\n                </td>\n            </tr>\n            `),u.insertAdjacentHTML("beforeend",`\n\n                           \n                                <option value="${t.id}">${t.name}</option>\n       \n        \n        `)}))}(t)}))};t.addEventListener("input",(function(){i.name=t.value,d()})),c.addEventListener("input",(function(){const t=c.files[0];if("image/png"===t.type||"image/jpeg"===t.type||"image/jpg"===t.type){const e=new FileReader;e.onload=function(){return i.preview=e.result},e.onerror=function(){return i.preview="",c.value=""},e.readAsDataURL(t)}else c.value="";d()})),r.addEventListener("click",(function(){n("/categories",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).then((function(){t.value="",c.value="",l()}))})),a.addEventListener("click",(function(t){if("BUTTON"===t.target.tagName){const e=t.target.dataset.category;o(`/categories/${e}`).then((function(t){l()}))}})),l(),d()}(),function(){const t=document.getElementById("product-title"),c=document.getElementById("product-price"),r=document.getElementById("product-name"),a=document.getElementById("product-image"),u=document.getElementById("product-add-btn"),i=document.getElementById("product-table"),d=document.getElementById("product-category"),l={title:"",name:"",price:0,preview:"",category:0},s=function(t){i.innerHTML=" ",t.forEach((function(t,e){i.insertAdjacentHTML("beforeend",`\n            <tr>\n                                        <th scope="row">${e+1}</th>\n                                        <td>${t.title}</td>\n                                        <td>${t.name}</td>\n                                        <td>${t.price} ₽</td>\n                                        <td class="text-end">\n                                            <button type="button" class="btn btn-outline-danger btn-sm" data-product= "${t.id}">\n                                                удалить\n                                            </button>\n                                        </td>\n                                    </tr>\n            `)})),console.log(t)},f=function(){""===r.value||""===a.value||0===Number(c.value)||""===t.value||"default"===d.value?u.disabled=!0:u.disabled=!1};d.addEventListener("change",(function(){l.category=d.value;const t="default"!==d.value?`/products?category=${d.value}`:"/products";console.log(d.value),e(t).then((function(t){s(t)})),f()})),t.addEventListener("input",(function(){l.title=t.value,f()})),r.addEventListener("input",(function(){l.name=r.value,f()})),c.addEventListener("input",(function(){l.price=Number(c.value),f()})),a.addEventListener("input",(function(){const t=a.files[0];if("image/png"===t.type||"image/jpeg"===t.type||"image/jpg"===t.type){const e=new FileReader;e.onload=function(){return l.preview=e.result},e.onerror=function(){return l.preview="",a.value=""},e.readAsDataURL(t)}else a.value="";f()}));const p=function(){e("/products").then((function(t){s(t)}))};u.addEventListener("click",(function(){n("/products",l).then((function(){r.value="",t.value="",c.value="",a.value="",p()}))})),i.addEventListener("click",(function(t){if("BUTTON"===t.target.tagName){const e=t.target.dataset.product;o(`/products/${e}`).then((function(t){p()}))}})),p(),f()}()})();